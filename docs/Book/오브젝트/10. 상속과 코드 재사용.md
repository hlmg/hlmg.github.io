# 10. 상속과 코드 재사용

## 01 상속과 중복 코드

중복 코드는 변경을 방해한다. 코드 수정과 테스트에 드는 비용을 증가시킨다. 중복 코드의 양이 많아질수록 코드를 변경하는 속도는 점점 느려진다.

중복 코드 판단 기준은 변경이다. 요구사항이 변경됐을 때 두 코드를 함께 수정해야 한다면 이 코드는 중복이다. 모양이 유사해도 함께 수정할 필요가 없다면 중복이 아니다.

DRY 원칙
> 모든 지식은 시스템 내에서 단일하고, 애매하지 않고, 정말로 믿을 만한 표현 양식을 가져야 한다.

### 상속을 이용해 중복 코드 제거하기

상속의 기본 아이디어는 중복되는 코드를 부모 클래스에 두고 코드를 재사용하는 것이다.

상속의 단점

- 결합도를 높인다
    - 자식 클래스가 부모 클래스의 구현 방법에 대한 정확한 지식을 가져야 한다.
- 취약한 기반 클래스 문제
    - 자식 클래스가 부모 클래스의 변경에 영향을 받는다.

:::tip 상속을 위한 경고

1. 자식 클래스 메서드 안에서 super 참조로 부모 클래스의 메서드를 직접 호출하면 두 클래스는 강하게 결합된다. super 호출을 제거해서 결합도를 낮추자.
2. 상속받은 부모 클래스의 메서드가 자식 클래스의 내부 구조에 대한 규칙을 깨트릴 수 있다. (e.g. Vector와 Stack, Hashtable과 Properties)
3. 자식 클래스가 부모 클래스 메서드를 오버라이딩할 경우 부모 클래스가 자신의 메서드를 사용하는 방법에 자식 클래스가 결합될 수 있다.
4. 클래스를 상속하면 결합도로 인해 자식 클래스와 부모 클래스의 구현을 영원히 변경하지 않거나 동시에 변경하거나 둘 중 하나를 선택할 수밖에 없다.

:::

상속을 위해 클래스를 설계하고 문서화하는 경우가 아니면 상속을 하지 말자.

상속은 코드 재사용을 위해 캡슐화를 희생한다(내부 구현 문서화). 완벽한 캡슐화를 원한다면 코드 재사용을 포기하거나 다른 방법을 사용해야 한다.

### 추상화에 의존하자

부모 클래스와 자식 클래스 모두 추상화에 의존해야 한다.

1. 중복 코드 안에서 차이점을 별도의 메서드로 추출하자.
    - 변하는 것으로부터 변하지 않는 것을 분리하라.
2. 중복 코드를 부모 클래스로 올려라
3. 중복 코드는 추상 메서드에 의존하고, 하위 클래스는 그 추상 메서드를 구현해라

추상화에 의존하기 때문에 부모 클래스의 내부 구현이 변경되더라도 자식 클래스가 영향을 받지 않는다. (낮은 결합도)

메서드 구현에 대한 결합은 추상 메서드를 추가해서 낮출 수 있지만, 인스턴스 변수에 대한 결합을 제거할 수 있는 방법은 없다. 정말 필요한 경우에만 상속을 사용하자.
